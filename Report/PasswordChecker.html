<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Password Strength Checker (Client-side)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f8f9fa;--fg:#222;--card:#fff;--muted:#6b7280;--brand:#2c3e50;
    --accent:#3498db;--border:#e6e9ef;
  }
  *{box-sizing:border-box}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;line-height:1.7;margin:0;background:var(--bg);color:var(--fg)}
  header{background:var(--brand);color:#fff;text-align:center;padding:1.5rem 1rem}
  header h1{margin:0;font-size:1.6rem}
  main{max-width:1000px;margin:2rem auto;padding:0 1rem}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:0 6px 14px rgba(0,0,0,.06);padding:1.5rem;margin-bottom:1.25rem}
  h2{margin:0 0 .75rem;color:var(--brand);font-size:1.2rem;border-bottom:2px solid #f0f2f5;padding-bottom:.4rem}
  .row{display:grid;gap:1rem;grid-template-columns:1fr}
  @media(min-width:900px){.row.two{grid-template-columns:1.1fr .9fr}}
  .input-wrap{display:flex;gap:.5rem;align-items:center;background:#f5f7fb;border:1px solid var(--border);padding:.6rem .75rem;border-radius:10px}
  .input-wrap input{width:100%;border:none;outline:none;background:transparent;font-size:1rem}
  .controls{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem}
  .btn{appearance:none;border:1px solid var(--border);background:#fff;color:#111;padding:.55rem .9rem;border-radius:8px;cursor:pointer;font-weight:600}
  .btn:hover{border-color:#cfd6e3}
  .meter{height:14px;width:100%;background:#eef2f7;border-radius:100px;position:relative;overflow:hidden;border:1px solid #e0e6ef}
  .meter>span{position:absolute;left:0;top:0;bottom:0;width:0%;transition:width .25s ease;border-radius:100px}
  .badge{display:inline-block;padding:.2rem .5rem;border-radius:6px;background:#eef7ff;border:1px solid #d6e8fb;color:#1a64a6;font-size:.85rem}
  .kvs{display:grid;grid-template-columns:160px 1fr;gap:.5rem .75rem}
  ul{margin:.4rem 0 0 1rem;padding:0} li{margin:.25rem 0}
  pre{background:#f6f8fb;border:1px solid var(--border);padding:.8rem 1rem;border-radius:10px;overflow-x:auto}
  .hint{color:var(--muted);font-size:.92rem;margin-top:.35rem}
  footer{text-align:center;color:#6b7280;font-size:.9rem;padding:1.5rem 1rem 3rem}
</style>
</head>
<body>
<header>
  <h1>üîí Password Strength Checker</h1>
  <p style="opacity:.85;margin:.35rem 0 0">All checks run <strong>locally</strong> in your browser.</p>
</header>

<main>
  <section class="card">
    <h2>Enter a password</h2>
    <div class="input-wrap">
      <input id="pw" type="password" placeholder="Type password to evaluate‚Ä¶" autocomplete="off"/>
      <button id="toggle" class="btn" type="button" aria-label="Show/Hide">üëÅÔ∏è</button>
    </div>
    <div class="controls">
      <button id="gen" class="btn" type="button">Generate random</button>
      <button id="clear" class="btn" type="button">Clear</button>
      <label style="color:#6b7280"><input type="checkbox" id="debug"/> Show debug</label>
    </div>
    <p class="hint">Aim for <strong>14‚Äì16+ chars</strong> mixing <em>upper/lower/digits/symbols</em>. Avoid sequences, keyboard patterns, repeats, years, and dictionary words.</p>
  </section>

  <section class="row two">
    <div class="card">
      <h2>Score & Verdict</h2>
      <div class="meter" aria-label="strength meter"><span id="meterFill"></span></div>
      <p style="margin:.5rem 0 0">
        Score: <strong id="score">0</strong>/100 &nbsp;‚Ä¢&nbsp; Verdict: <span id="verdict" class="badge">Very Weak</span>
      </p>
      <div style="margin-top:1rem" class="kvs">
        <div>Length</div><div id="len">0</div>
        <div>Classes used</div><div><span id="classes">0</span> of 5 (lower/upper/digits/symbols/space)</div>
        <div>Estimated entropy</div><div><span id="entropy">0.0</span> bits</div>
        <div>Charset size</div><div id="charset">0</div>
      </div>
    </div>

    <div class="card">
      <h2>Weaknesses & Suggestions</h2>
      <div>
        <strong>Weaknesses</strong>
        <ul id="reasons"></ul>
      </div>
      <div style="margin-top:.65rem">
        <strong>Suggestions</strong>
        <ul id="sugs"></ul>
      </div>
    </div>
  </section>

  <section class="card" id="dbgCard" style="display:none">
    <h2>Debug (calculation details)</h2>
    <pre id="debugOut"></pre>
  </section>

  <section class="card">
    <h2>How this works</h2>
    <p>Ported from your Python logic: character-class analysis, a rough entropy bound (<code>length √ó log2(charset)</code>), and penalties for risky patterns (common passwords, dictionary words, sequences, keyboard runs, repetition, year suffix).</p>
  </section>
</main>

<footer>Built for local evaluation ¬∑ No data leaves your browser.</footer>

<script>
/* ===== Data (ported) ===== */
const COMMON_PASSWORDS = new Set([
  "123456","123456789","12345","qwerty","password","111111","12345678",
  "abc123","password1","iloveyou","admin","welcome","monkey","dragon",
  "qwerty123","letmein","football","baseball","1q2w3e4r","asdfgh",
  "zaq12wsx","passw0rd","000000","qazwsx","sunshine","princess",
].map(s=>s.toLowerCase()));

const DICTIONARY_WORDS = [
  "love","secret","money","music","login","master","super","school",
  "student","summer","winter","spring","admin","guest","hero",
];

const KEYBOARD_ROWS = ["1234567890","qwertyuiop","asdfghjkl","zxcvbnm"];
const PUNCT = `!"#$%&'()*+,-./:;<=>?@[\\]^_\`{|}~`;

/* ===== Helpers ===== */
const classifyChars = (pw)=>{
  let lower=0,upper=0,digits=0,symbols=0,spaces=0;
  for(const c of pw){
    if(c>='a'&&c<='z') lower++;
    else if(c>='A'&&c<='Z') upper++;
    else if(c>='0'&&c<='9') digits++;
    else if(c===' ') spaces++;
    else if(PUNCT.includes(c)) symbols++;
    else symbols++; // treat other unicode punct as symbols
  }
  return {length:pw.length,lower,upper,digits,symbols,spaces};
};
const charsetSize = (st)=>{
  let n=0;
  if(st.lower>0) n+=26;
  if(st.upper>0) n+=26;
  if(st.digits>0) n+=10;
  if(st.symbols>0) n+=PUNCT.length;
  if(st.spaces>0) n+=1;
  return Math.max(n,1);
};
const entropyBits = (st)=> st.length * Math.log2(charsetSize(st));
const hasSimpleSequence = (pw)=>{
  const s=pw.toLowerCase();
  for(let i=0;i<=s.length-3;i++){
    const a=s[i],b=s[i+1],c=s[i+2];
    if(/[a-z]/.test(a+b+c)){
      if(b.charCodeAt(0)-a.charCodeAt(0)===1 && c.charCodeAt(0)-b.charCodeAt(0)===1) return true;
      if(a.charCodeAt(0)-b.charCodeAt(0)===1 && b.charCodeAt(0)-c.charCodeAt(0)===1) return true;
    }
    if(/[0-9]/.test(a+b+c)){
      const ai=+a,bi=+b,ci=+c;
      if(bi-ai===1 && ci-bi===1) return true;
      if(ai-bi===1 && bi-ci===1) return true;
    }
  }
  return false;
};
const hasKeyboardSequence = (pw)=>{
  const s=pw.toLowerCase();
  for(const row of KEYBOARD_ROWS){
    for(let i=0;i<=row.length-3;i++){
      const seg=row.slice(i,i+3);
      if(s.includes(seg) || s.includes(seg.split("").reverse().join(""))) return true;
    }
  }
  return false;
};
const hasRepetition = (pw)=> /(.)\1\1/.test(pw) || /(..)\1\1/.test(pw);
const looksLikeYearSuffix = (pw)=> /(19|20)\d{2}$/.test(pw);
const containsDictionaryWord = (pw)=>{
  const s=pw.toLowerCase();
  for(const w of DICTIONARY_WORDS){
    if(w.length>=4 && s.includes(w)) return true;
  }
  return false;
};
const isCommonPassword = (pw)=> COMMON_PASSWORDS.has(pw.toLowerCase());

/* ===== Scoring (ported) ===== */
function scorePassword(pw){
  const st = classifyChars(pw);
  const ent = entropyBits(st);
  const classesUsed = ["lower","upper","digits","symbols","spaces"].reduce((n,k)=>n+(st[k]>0?1:0),0);

  let score = 0;
  score += Math.min(40, st.length * 3);                     // length (max 40)
  score += Math.max(0, (classesUsed - 1) * 10);             // diversity (max 40)
  score += Math.max(0, Math.min(20, Math.floor((ent - 28)/2))); // entropy bonus (max 20)

  const reasons = [];
  if(isCommonPassword(pw)){ reasons.push("Matches very common password lists"); score -= 40; }
  if(hasSimpleSequence(pw)){ reasons.push("Contains consecutive sequences (e.g., abc, 123)"); score -= 25; }
  if(hasKeyboardSequence(pw)){ reasons.push("Contains keyboard patterns (e.g., qwe, asd)"); score -= 20; }
  if(hasRepetition(pw)){ reasons.push("Contains repeated characters/patterns (e.g., aaaa, abab)"); score -= 20; }
  if(containsDictionaryWord(pw)){ reasons.push("Contains a common dictionary word"); score -= 15; }
  if(looksLikeYearSuffix(pw)){ reasons.push("Ends with a year (YYYY)"); score -= 10; }
  if(classesUsed===1){ reasons.push("Uses only one character class"); score -= 20; }
  if(st.length<12){ reasons.push("Shorter than 12 characters"); score -= 15; }

  score = Math.max(0, Math.min(100, score));

  let verdict="Very Weak";
  if(score>=80) verdict="Very Strong";
  else if(score>=60) verdict="Strong";
  else if(score>=40) verdict="Fair";
  else if(score>=20) verdict="Weak";

  const suggestions=[];
  if(st.length<12) suggestions.push("Make your password at least 12 characters long (preferably 14‚Äì16).");
  if(classesUsed<3) suggestions.push("Use at least three of: uppercase, lowercase, digits, symbols.");
  if(hasSimpleSequence(pw)||hasKeyboardSequence(pw)) suggestions.push("Avoid consecutive or keyboard patterns (e.g., 1234, qwerty).");
  if(hasRepetition(pw)) suggestions.push("Avoid repeated characters or patterns (e.g., aaaa, abab).");
  if(containsDictionaryWord(pw)||isCommonPassword(pw)) suggestions.push("Avoid dictionary words or common passwords; use a password manager to generate random ones.");
  suggestions.push("Always enable MFA (multi-factor authentication) for important accounts.");

  return {score, verdict, reasons, suggestions, st, ent, classesUsed};
}

/* ===== UI ===== */
const $ = s => document.querySelector(s);
const pwEl=$("#pw"), toggle=$("#toggle"), gen=$("#gen"), clr=$("#clear"), dbg=$("#debug");
const meter=$("#meterFill"), scoreEl=$("#score"), verdictEl=$("#verdict");
const lenEl=$("#len"), clsEl=$("#classes"), entEl=$("#entropy"), charsetEl=$("#charset");
const reasonsEl=$("#reasons"), sugsEl=$("#sugs"), dbgCard=$("#dbgCard"), dbgOut=$("#debugOut");

function setMeter(score){
  meter.style.width = score + "%";
  let color = "#e15241"; // red
  if(score>=80) color="#2ecc71";
  else if(score>=60) color="#27ae60";
  else if(score>=40) color="#f1c40f";
  else if(score>=20) color="#e67e22";
  meter.style.background = color;
}
function setVerdictBadge(v){
  verdictEl.textContent = v;
  const map={
    "Very Weak": ["#ffe5e5","#ffc7c7","#b71c1c"],
    "Weak": ["#fff1e0","#ffd7b3","#9c5315"],
    "Fair": ["#fff8d8","#ffe89a","#7a6610"],
    "Strong": ["#e7f7ec","#bfe8cb","#1e7b4d"],
    "Very Strong": ["#e1f7ee","#aee8c9","#145f3c"],
  };
  const [bg,bd,txt]=map[v]||["#eef7ff","#d6e8fb","#1a64a6"];
  verdictEl.style.background=bg; verdictEl.style.borderColor=bd; verdictEl.style.color=txt;
}
function render(pw){
  const {score, verdict, reasons, suggestions, st, ent, classesUsed} = scorePassword(pw);
  setMeter(score);
  setVerdictBadge(verdict);
  scoreEl.textContent = String(score);
  lenEl.textContent = String(st.length);
  clsEl.textContent = String(classesUsed);
  entEl.textContent = (isFinite(ent)? ent.toFixed(1):"0.0");
  charsetEl.textContent = String(charsetSize(st));

  reasonsEl.innerHTML = reasons.map(r=>`<li>${r}</li>`).join("") || "<li>No obvious weaknesses found.</li>";
  sugsEl.innerHTML = suggestions.map(s=>`<li>${s}</li>`).join("");

  if(dbg.checked){
    dbgCard.style.display="block";
    dbgOut.textContent = JSON.stringify(
      {stats:st, classesUsed, entropy_bits:ent, score, verdict}, null, 2
    );
  } else {
    dbgCard.style.display="none";
    dbgOut.textContent="";
  }
}

/* Events */
pwEl.addEventListener("input", e=>render(e.target.value));
toggle.addEventListener("click", ()=>{
  pwEl.type = pwEl.type==="password" ? "text" : "password";
  toggle.textContent = pwEl.type==="password" ? "üëÅÔ∏è" : "üôà";
});
gen.addEventListener("click", ()=>{
  // Generate a 16‚Äì20 char random pass incl. all classes
  const lowers="abcdefghijklmnopqrstuvwxyz";
  const uppers="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  const digits="0123456789";
  const symbols=PUNCT;
  const pools=[lowers,uppers,digits,symbols];
  const len=16+Math.floor(Math.random()*5);
  let pw="";
  // ensure at least one from each
  pw += lowers[Math.floor(Math.random()*lowers.length)];
  pw += uppers[Math.floor(Math.random()*uppers.length)];
  pw += digits[Math.floor(Math.random()*digits.length)];
  pw += symbols[Math.floor(Math.random()*symbols.length)];
  const all=pools.join("");
  for(let i=4;i<len;i++) pw += all[Math.floor(Math.random()*all.length)];
  // shuffle
  pw = pw.split("").sort(()=>Math.random()-0.5).join("");
  pwEl.value=pw; render(pw);
});
clr.addEventListener("click", ()=>{ pwEl.value=""; render(""); });
dbg.addEventListener("change", ()=>render(pwEl.value));

/* Initial */
render("");
</script>
</body>
</html>
